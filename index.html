<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<title>ComentaTuVida</title>
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<link rel="stylesheet" href="style.css"/>
	</head>
	<body>
		<header>
			<input type="checkbox" class="checkbox" id="menu-toogle"/>
			<label for="menu-toogle" class="menu-toogle"></label>
			<nav>
				<ul>
					<li><input type="text" name="buscar" value="" placeholder="Busqueda"/></li>
					<li class="item"><a href="pagina1.html"><i class="material-icons">person</i>Login</a></li>
					<li class="item"><a href="pagina2.html"><i class="material-icons">person_add</i>Registro</a></li>
					<li class="item"><a href="pagina3.html"><i class="material-icons">cancel</i>LogOut</a></li>
					<li class="item"><a href="pagina4.html"><i class="material-icons">add_circle</i>Nuevo</a></li>
					<li class="info">
						<h1>ComentaTuVida</h1>
						<p>La web de comentarios lider.</p>
					</li>
					<li class="cat"><a href="pagina5.html">Inicio</a></li>
					<li class="cat"><a href="pagina5.html">Eventos</a></li>
					<li class="cat"><a href="pagina5.html">Retos</a></li>
				</ul>
			</nav>
			<div class="logo">
				<img src="logo.png">
			</div>
			<div class="headerinfo">
				<h1 class="title">ComentaTuVida</h1>
				<p class="subtitle">La web de comentarios lider.</p>
			</div>
			<div class="headerlinks">
				<a href="pagina1.html"><i class="material-icons">person</i>Login</a>
				<a href="pagina2.html"><i class="material-icons">person_add</i>Registro</a>
				<a href="pagina3.html"><i class="material-icons">cancel</i>LogOut</a>
				<a href="pagina4.html"><i class="material-icons">add_circle</i>Nuevo</a>
			</div>
		</header>
		<main>
			<section class="articles">
				<h2>Ultimos artículos</h2>
				<div class="a-container">

				</div>
				<div class="a-pagination">
					
				</div>
				<template>
					<article>
						<div class="aheader">
							<a href=""><img src="" alt=""/></a>
						</div>
						<div class="abody">
							<a href=""><h3></h3></a>
							<p class="descripcion"></p>
						</div>
						<div class="afooter">
							<p class="autor"></p>
							<p class="numcom"></p>
							<p class="fecha"></p>
							<p class="numfotos"></p>
						</div>
					</article>
				</template>
			</section>
			<section class="c-section">
				<h2>Últimos comentarios</h2>
				<div class="comments">
				</div>
				<template>
					<div>
						<a href=""><h3></h3></a>
						<b></b>
						<p></p>
						<i class="autor"></i> - <i class="fecha"></i>
					</div>
				</template>
			</section>
		</main>
		<footer>
			<p>Footer de la pagina</p>
		</footer>
		<script>
			var nEntradas = 6;
			var nPagina = 1;
			var nComentarios = 10;
			ajaxGetRequest("rest/entrada/?u="+nEntradas, function(res){
				let entradas = document.querySelectorAll('.a-container article')
				for (let entrada of entradas){
					entrada.remove();
				}
				let plantilla = document.querySelector('.articles template');
				for (let fila of res.FILAS){
					let elem = plantilla.content.cloneNode(true);
                
	                elem.querySelector('.aheader a').href = 'http://localhost/practica2/entradas.html?id='+fila.id;
	                elem.querySelector('.aheader img').src = 'http://localhost/practica2/fotos/'+fila.fichero;
	                elem.querySelector('.aheader img').alt = 'http://localhost/practica2/fotos/'+fila.nombre;
	                elem.querySelector('.abody a').href = 'http://localhost/practica2/entradas.html?id='+fila.id;
					elem.querySelector('.abody h3').innerHTML = fila.nombre;
					elem.querySelector('.abody .descripcion').innerHTML = fila.descripcion;
					elem.querySelector('.afooter .autor').innerHTML = fila.login;
					elem.querySelector('.afooter .numcom').innerHTML = fila.ncomentarios;
					elem.querySelector('.afooter .numfotos').innerHTML = fila.nfotos;
					elem.querySelector('.afooter .fecha').innerHTML = fila.fecha;

	                document.querySelector('.a-container').appendChild(elem);
				}
				if (nPagina > 1){
					document.querySelector('.a-pagination').innerHTML = '<a href="#">&lt;&lt;</a><a href="#">&lt;</a><b>'+nPagina+' de 12</b><a href="#">&gt;</a><a href="#">&gt;&gt;</a>';
				} else {
					document.querySelector('.a-pagination').innerHTML = '<b>'+nPagina+' de 12</b><a href="#">&gt;</a><a href="#">&gt;&gt;</a>';
				}
			});
			ajaxGetRequest("rest/comentario/?u="+nComentarios, function(res){
				let comentarios = document.querySelectorAll('.comments div')
				for (let comentario of comentarios){
					comentario.remove();
				}
				let plantilla = document.querySelector('.c-section>template');
				for (let fila of res.FILAS){
					let elem = plantilla.content.cloneNode(true);
					elem.querySelector('a').href='http://localhost/practica2/entradas.html?id='+fila.id+"#comments";
					elem.querySelector('h3').innerHTML=fila.titulo; //ToDo: Aqui titulo del post
					elem.querySelector('b').innerHTML=fila.titulo;
					elem.querySelector('p').innerHTML=fila.texto;
					elem.querySelector('i.autor').innerHTML=fila.login;
					elem.querySelector('i.fecha').innerHTML=fila.fecha;
	                document.querySelector('.comments').appendChild(elem);
				}
			});
			//sessionStorage.setItem("login", "false");
			if (sessionStorage.getItem("login") == "true"){
				var items = document.querySelectorAll(".loggedin");
				for (var item of items){
					item.style.display = "block";
				}
				var items = document.querySelectorAll(".loggedout");
				for (var item of items){
					item.style.display = "none";
				}
			} else {
				var items = document.querySelectorAll(".loggedin");
				for (var item of items){
					item.style.display = "none";
				}
				var items = document.querySelectorAll(".loggedout");
				for (var item of items){
					item.style.display = "block";
				}
			}
		</script>
	</body>
</html>